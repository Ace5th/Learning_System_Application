<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTA | FEB Universitas Hasanuddin</title>
    <link rel="icon" type="image/icon type"
        href="https://res.cloudinary.com/dpghf08pr/image/upload/v1661885348/UNHAS-SISTA/WEB-RESOURCE/Universitas_Hasanuddin_Official_Logo_bf63rx.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="/stylesheets/dashboardStudents.css">
</head>

<body>
    <div class="dashboard-page d-flex flex-column vh-100">
        <%- include("../partials/navbarStudents") %>

            <header class="dashboard-header">
                <div class="container-fluid header-container">
                    <h1 class="page-title display-1 fw-bold dasboard-title text-light">DASHBOARD</h1>
                </div>
            </header>

            <main class="dashboard-main mb-5">
                <div class="container px-5">
                    <%- include("../flash") %>
                </div>
                <div class="row mt-4">
                    <div class="col-md-8 offset-md-2">
                        <div class="card shadow mb-2 py-1 text-bg-dark">
                            <h3 class="ps-3 py-1">MY PROFILE</h3>
                        </div>

                        <div class="card shadow">
                            <div class="card-body row">
                                <div class="col-md-6">
                                    <label class="h4" for="student-username">NIM</label>
                                    <div class="card">
                                        <p class="card-text profile-label" id="student-username">
                                            <%= student.username %>
                                        </p>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <label class="h4" for="student-name">NAME</label>
                                    <div class="card">
                                        <p class="card-text profile-label" id="student-name">
                                            <%= student.name %>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-md-8 offset-md-2">
                        <div class="card shadow mb-2 py-1 text-bg-dark">
                            <h3 class="ps-3 py-1">SUPERVISORS</h3>
                        </div>

                        <div class="card shadow">
                            <div class="card-body row">
                                <% if (student.firstLecturer !=undefined) { %>
                                    <h4 class="ps-3 py-1 mb-0 fw-bold">1<sup>ST</sup> SUPERVISOR
                                    </h4>

                                    <div class="col-md-6 assigned-lecturers">
                                        <label class="h4" for="first-lecturer-username">NIP</label>
                                        <div class="card">
                                            <p class="card-text profile-label" id="first-lecturer-username">
                                                <%= student.firstLecturer.username %>
                                            </p>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="h4" for="first-lecturer-name">NAME</label>
                                        <div class="card">
                                            <p class="card-text profile-label" id="first-lecturer-name">
                                                <%= student.firstLecturer.name %>
                                            </p>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-4">
                                        <label class="h4" for="first-lecturer-email">E-MAIL</label>
                                        <div class="card">
                                            <p class="card-text profile-label" id="first-lecturer-email">
                                                <%= student.firstLecturer.email %>
                                            </p>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-4">
                                        <label class="h4" for="first-lecturer-department">DEPARTMENT</label>
                                        <div class="card">
                                            <p class="card-text profile-label" id="first-lecturer-department">
                                                <%= student.firstLecturer.department %>
                                            </p>
                                        </div>
                                    </div>
                                    <% } %>

                                        <% if (student.secondLecturer !=undefined) { %>
                                            <h4 class="ps-3 py-1 mb-0 fw-bold">2<sup>ND</sup> SUPERVISOR
                                            </h4>

                                            <div class="col-md-6 assigned-lecturers">
                                                <label class="h4" for="second-lecturer-username">NIP</label>
                                                <div class="card">
                                                    <p class="card-text profile-label" id="second-lecturer-username">
                                                        <%= student.secondLecturer.username %>
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <label class="h4" for="second-lecturer-name">NAME</label>
                                                <div class="card">
                                                    <p class="card-text profile-label" id="second-lecturer-name">
                                                        <%= student.secondLecturer.name %>
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="col-md-6 mb-3">
                                                <label class="h4" for="second-lecturer-email">E-MAIL</label>
                                                <div class="card">
                                                    <p class="card-text profile-label" id="second-lecturer-email">
                                                        <%= student.secondLecturer.email %>
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="col-md-6 mb-3">
                                                <label class="h4" for="second-lecturer-department">DEPARTMENT</label>
                                                <div class="card">
                                                    <p class="card-text profile-label" id="second-lecturer-department">
                                                        <%= student.secondLecturer.department %>
                                                    </p>
                                                </div>
                                            </div>
                                            <% } %>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row assignment-side mb-3">
                    <div class="col-md-8 offset-md-2">
                        <div class="card shadow mb-2 py-2 text-bg-dark">
                            <h2 class="ps-3 py-1">ASSIGNMENTS</h2>
                        </div>

                        <div class="card shadow">
                            <div class="card-body row py-3">
                                <% if (student.firstLecturer && student.secondLecturer) { %>
                                    <% if (student.assignments.length==0) { %>
                                        <a href="/student/assignment/phases"
                                            class="btn btn-sm btn-secondary mb-2 ms-2 col-md-2">Create
                                            New</a>
                                        <% } else if (student.assignments.length==1) { %>
                                            <% if (student.assignments[0].status=="Accepted" ) { %>
                                                <a href="/student/assignment/phases"
                                                    class="btn btn-sm btn-secondary mb-2 ms-2 col-md-2">Create New</a>
                                                <% } %>
                                                    <% } %>
                                                        <% } %>
                                                            <table class="table table-striped-columns">
                                                                <thead>
                                                                    <tr>
                                                                        <th scope="col">TITLE</th>
                                                                        <th scope="col">PHASE</th>
                                                                        <th scope="col" colspan="2">STATUS</th>
                                                                        <th scope="col">REVIEWS</th>
                                                                        <th scope="col">TIME UPDATED</th>
                                                                        <th scope="col">DEADLINE</th>
                                                                        <th scope="col">ACTIONS</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <% for (let assignment of student.assignments) { %>
                                                                        <% if (assignment.status=="Accepted" ) { %>
                                                                            <tr class="table-success">
                                                                                <% } else { %>
                                                                            <tr>
                                                                                <% } %>
                                                                                    <th scope="row">
                                                                                        <%= assignment.title %>
                                                                                    </th>
                                                                                    <td class="text-center">
                                                                                        <%= assignment.phase %>
                                                                                    </td>
                                                                                    <td>
                                                                                        <%= assignment.status %>
                                                                                    </td>
                                                                                    <td>
                                                                                        <ul>
                                                                                            <% if (student.firstLecturer
                                                                                                !=undefined) { %>
                                                                                                <li>
                                                                                                    <strong>1<sup>ST</sup>
                                                                                                        SUPERVISOR:</strong>
                                                                                                    <br>
                                                                                                    <strong>
                                                                                                        <%= assignment.statusOfFirstLecturer.code
                                                                                                            %>
                                                                                                    </strong>
                                                                                                    | <%=
                                                                                                        student.firstLecturer.username
                                                                                                        %> |
                                                                                                        <%= student.firstLecturer.name
                                                                                                            %> | <%=
                                                                                                                student.firstLecturer.department
                                                                                                                %>
                                                                                                </li>
                                                                                                <% } %>

                                                                                                    <% if
                                                                                                        (student.secondLecturer
                                                                                                        !=undefined) {
                                                                                                        %>
                                                                                                        <li>
                                                                                                            <strong>2<sup>ND</sup>
                                                                                                                SUPERVISOR:</strong>
                                                                                                            <br>
                                                                                                            <strong>
                                                                                                                <%= assignment.statusOfSecondLecturer.code
                                                                                                                    %>
                                                                                                            </strong> |
                                                                                                            <%= student.secondLecturer.username
                                                                                                                %>
                                                                                                                |
                                                                                                                <%= student.secondLecturer.name
                                                                                                                    %>
                                                                                                                    |
                                                                                                                    <%= student.secondLecturer.department
                                                                                                                        %>
                                                                                                        </li>
                                                                                                        <% } %>
                                                                                        </ul>
                                                                                    </td>
                                                                                    <td class="text-center">
                                                                                        <%= assignment.reviews.length %>
                                                                                    </td>
                                                                                    <td>
                                                                                        <%= assignment.time.updatedOn.toLocaleDateString()
                                                                                            %>
                                                                                    </td>
                                                                                    <td>
                                                                                        <% if
                                                                                            (assignment.status=="Under Review by Lecturers"
                                                                                            ) { %>
                                                                                            Lecturer(s) |
                                                                                            <% } else { %>
                                                                                                Student |
                                                                                                <% } %>
                                                                                                    <%= assignment.time.expiresOn.toLocaleDateString()
                                                                                                        %>
                                                                                                        <strong>(
                                                                                                            <%= assignment.elapsedTimeDay
                                                                                                                %>
                                                                                                                Days
                                                                                                                Left)
                                                                                                        </strong>
                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="dropdown">
                                                                                            <button
                                                                                                class="btn btn-sm btn-secondary dropdown-toggle"
                                                                                                type="button"
                                                                                                data-bs-toggle="dropdown"
                                                                                                aria-expanded="false">
                                                                                                &#8226;&#8226;&#8226;
                                                                                            </button>
                                                                                            <ul
                                                                                                class="dropdown-menu dropdown-menu-dark">
                                                                                                <% if
                                                                                                    (assignment.status=="Under Editing by Student"
                                                                                                    ||
                                                                                                    assignment.override==true
                                                                                                    ) { %>
                                                                                                    <li><a class="dropdown-item"
                                                                                                            href="/student/assignment/<%= assignment._id %>/edit-assignment">Update</a>
                                                                                                    </li>
                                                                                                    <% } %>
                                                                                                        <li><a class="dropdown-item"
                                                                                                                href="/student/download-assignment/<%= assignment._id %>">Download
                                                                                                                PDF</a>
                                                                                                        </li>
                                                                                                        <li><a class="dropdown-item"
                                                                                                                href="/student/assignment/<%= assignment._id %>/delete-assignment">Remove</a>
                                                                                                        </li>
                                                                                                        <li><a class="dropdown-item"
                                                                                                                href="/student/assignment/<%= assignment._id %>">Detail</a>
                                                                                                        </li>
                                                                                                        <li><a class="dropdown-item"
                                                                                                                href="/student/assignment/<%= assignment._id %>/reviews">Reviews</a>
                                                                                                        </li>
                                                                                                        <li><a class="dropdown-item"
                                                                                                                href="/student/assignment/<%= assignment._id %>/history">History</a>
                                                                                                        </li>
                                                                                            </ul>
                                                                                        </div>
                                                                                    </td>
                                                                            </tr>
                                                                            <% } %>
                                                                </tbody>
                                                            </table>
                            </div>
                        </div>
                    </div>
                </div>

                <% if ( student.assignments.length==2 && student.assignments[0].status=="Accepted" &&
                    student.assignments[1].status=="Accepted" ) { %>
                    <div class="row">
                        <div class="col-md-8 offset-md-2">
                            <div class="card shadow mb-2 py-2 text-bg-dark">
                                <h2 class="ps-3 py-1">LETTER OF APPROVAL</h2>
                            </div>

                            <div class="card shadow">
                                <div class="card-body row py-3">
                                    <% if (student.letterOfApproval==undefined) { %>
                                        <a href="/student/loa"
                                            class="btn btn-sm btn-secondary mb-2 ms-2 col-md-2">Create
                                            New</a>
                                        <% } %>

                                            <table class="table table-striped-columns">
                                                <thead>
                                                    <tr>
                                                        <th scope="col" colspan="2">STATUS</th>
                                                        <th scope="col">TIME UPDATED</th>
                                                        <th scope="col">DEADLINE</th>
                                                        <th scope="col">ACTIONS</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% if (student.letterOfApproval) { %>
                                                        <% if (student.letterOfApproval.status=="Approved" ) { %>
                                                            <tr class="table-success">
                                                                <% } else { %>
                                                            <tr>
                                                                <% } %>
                                                                    <th scope="row">
                                                                        <%= student.letterOfApproval.status %>
                                                                    </th>
                                                                    <td>
                                                                        <ul>
                                                                            <% if (student.firstLecturer !=undefined) {
                                                                                %>
                                                                                <li>
                                                                                    <strong>1<sup>ST</sup>
                                                                                        SUPERVISOR:</strong>
                                                                                    <br>
                                                                                    <strong>
                                                                                        <%= student.letterOfApproval.statusOfFirstLecturer.code
                                                                                            %>
                                                                                    </strong>| <%=
                                                                                        student.firstLecturer.username
                                                                                        %>
                                                                                        |
                                                                                        <%= student.firstLecturer.name
                                                                                            %> |
                                                                                            <%= student.firstLecturer.department
                                                                                                %>
                                                                                </li>
                                                                                <% } %>
                                                                                    <% if (student.secondLecturer
                                                                                        !=undefined) { %>
                                                                                        <li>
                                                                                            <strong>2<sup>ND</sup>
                                                                                                SUPERVISOR:</strong>
                                                                                            <br>
                                                                                            <strong>
                                                                                                <%= student.letterOfApproval.statusOfSecondLecturer.code
                                                                                                    %>
                                                                                            </strong> | <%=
                                                                                                student.secondLecturer.username
                                                                                                %> |
                                                                                                <%= student.secondLecturer.name
                                                                                                    %> |
                                                                                                    <%= student.secondLecturer.department
                                                                                                        %>
                                                                                        </li>
                                                                                        <% } %>
                                                                        </ul>
                                                                    </td>
                                                                    <td>
                                                                        <%= student.letterOfApproval.time.updatedOn.toLocaleDateString()
                                                                            %>
                                                                    </td>
                                                                    <td>
                                                                        <% if
                                                                            (student.letterOfApproval.status=="Waiting for Approval"
                                                                            ) { %>
                                                                            Lecturer(s) |
                                                                            <% } else { %>
                                                                                Student |
                                                                                <% } %>
                                                                                    <%= student.letterOfApproval.time.expiresOn.toLocaleDateString()
                                                                                        %>
                                                                                        <strong>(<%=
                                                                                                student.letterOfApproval.elapsedTimeDay
                                                                                                %>
                                                                                                Days
                                                                                                Left)</strong>
                                                                    </td>
                                                                    <td>
                                                                        <div class="dropdown">
                                                                            <button
                                                                                class="btn btn-sm btn-secondary dropdown-toggle"
                                                                                type="button" data-bs-toggle="dropdown"
                                                                                aria-expanded="false">
                                                                                &#8226;&#8226;&#8226;
                                                                            </button>
                                                                            <ul
                                                                                class="dropdown-menu dropdown-menu-dark">
                                                                                <li><a class="dropdown-item"
                                                                                        href="/student/download-loa/<%= student.letterOfApproval._id %>">Download
                                                                                        PDF</a></li>
                                                                                <li><a class="dropdown-item"
                                                                                        href="/student/loa/<%= student.letterOfApproval._id %>/delete-loa">Remove</a>
                                                                                </li>
                                                                                <li><a class="dropdown-item"
                                                                                        href="/student/loa/<%= student.letterOfApproval._id %>">Detail</a>
                                                                                </li>
                                                                                <li><a class="dropdown-item"
                                                                                        href="/student/loa/<%= student.letterOfApproval._id %>/history">History</a>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </td>
                                                            </tr>
                                                            <% } %>
                                                </tbody>
                                            </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>
            </main>

            <%- include("../partials/footerStudents") %>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
</body>

</html>